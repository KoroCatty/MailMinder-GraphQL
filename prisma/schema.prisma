// Every time you change this file, update MySQL DB by

// npx prisma db push

generator client {
  provider = "prisma-client-js" //JavaScript および TypeScript で動作する
  output   = "./generated/client"
  log     = ["query", "info", "warn", "error"]
  binaryTargets = ["native", "debian-openssl-1.1.x"]// Deploy to Render.com
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id        Int      @id @default(autoincrement())
  firstName String
  lastName  String
  email     String   @unique
  password  String
  createdAt DateTime @default(now())
  emailSend Boolean @default(true) 

  // Post Table との関係性
  posts Post[] // 1対多の関係なので配列 (a user can have many posts)
}


// 1対多のリレーションシップの典型的な方法は、"多" の側（この場合は Post）に  Userへの参照（外部キー）を持たせる。なので User table には　postId とレコードは作らない
model Post {
  id        Int      @id @default(autoincrement())
  title     String
  content   String   @db.Text  //  65535文字まで可能
  imgUrl    String   @db.VarChar(15000) // 15000文字まで可能
  imgCloudinaryUrl String? @db.Text //CLOUDINARY IMG URL
  imgCloudinaryId String? //CLOUDINARY ID
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

// 1対多の関係なので、Post table に userId を追加する
  userId Int
  user   User @relation(fields: [userId], references: [id])
}

